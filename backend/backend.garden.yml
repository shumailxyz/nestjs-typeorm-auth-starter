kind: Build
name: backend
description: Backend service container image
type: container

---
kind: Deploy
name: backend-service
description: Node service container
type: container

build: backend

spec:
  args: [ npm, run, start:dev ] # override 
  ports:
    - name: http
      containerPort: 3000
  ingresses:
    - path: /
      port: http
  sync:
    paths:
      - target: /app/src
        source: src
        mode: two-way
        exclude: [node_modules]

---

kind: Run
name: backend-test
type: container
build: backend
spec:
  command: ["node", "dist/main"]

---
kind: Test
name: backend-integ
description: Node service container integration tests
type: container

build: backend

spec:
  command: [ npm, run, test:e2e ]